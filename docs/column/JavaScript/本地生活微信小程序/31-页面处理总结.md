# 页面处理总结（三十一）



## 一、页面之间的导航跳转

  前面通过栗子学习了页面导航、页面事件和wxs脚本等相关内容，并根据这些完成案例-本地生活列表页面。接下来就来对这些所学内容的进行一个总结吧。话不多说，让我们原文再续，书接上回吧。



![](https://blogwnx-bucket.oss-cn-beijing.aliyuncs.com/img/c8bde1a1ee5e49b89554490a67e354bf.gif)

  回顾前面学习到的内容，首先先学习到的是能够知道如何实现页面之间的导航跳转。主要有两种实现方式：

- **声明式导航**
  主要由 navigator 组件来实现页面之间的跳转。
- **编程式导航**
  需要调用小程序的API来进行页面跳转，比如：`wx.switchTab(Object object)`、`wx.navigateTo(Object object)` 等。

## 二、实现下拉刷新效果

  这里需要掌握的是能够知道如何实现下拉刷新效果，实现步骤可分为两步：

- **Step 1、enablePullDownRefresh**

  通过 `enablePullDownRefresh` 属性来开启下拉刷新效果， 当在 `app.json` 中进行设置时是全局开启下拉刷新，而在实际开发过程中，不一定所有页面都要下拉刷新，所以只要在对应页面的 `.json` 文件里开启即可。

- **Step 2、 onPullDownRefresh**

   `onPullDownRefresh` 函数是下拉监听函数，可以将刷新内容放在该监听中。注意： 在使用下拉刷新效果的时候，需要调用 `wx.stopPullDownRefresh()` 隐藏下拉刷新的 `loading` 效果。

## 三、实现上拉加载更多效果

   通过前面的栗子基本上能够知道如何实现上拉加载更多效果，实现步骤可分为两步：

- **Step 1、onReachBottomDistance**

  通过 `onReachBottomDistance` 属性可以设置上拉触底的距离。

- **Step 2、 onPullDownRefresh**

  通过 `onReachBottom()` 函数即可监听当前页面的上拉触底事件。注意： 当连续触底多次，就会引发不必要的问题。所以需要在上拉监听函数做节流处理，如果当前请求正在请求数据，后续发送的请求都应该进行屏蔽。当前没有数据请求的时候，才可以允许发起下一页的请求。

## 四、小程序中常用的生命周期函数

  小程序中的生命周期函数分为两类，分别是：

| 生命周期 | 说明                                                         |
| -------- | ------------------------------------------------------------ |
| **应用** | 特指小程序从启动 -> 运行 -> 销毁期间依次调用的那些函数。     |
| **页面** | 特指小程序中，每个页面从加载 -> 渲染 -> 销毁期间依次调用的那些函数。 |

- **应用**

  小程序的应用生命周期函数需要在 app.js 中进行声明。

| 函数     | 说明                                                         |
| -------- | ------------------------------------------------------------ |
| onLaunch | 当小程序初始化完成时，会触发 onLaunch（全局只触发一次）。参数也可以使用 `wx.getLaunchOptionsSync` 获取。 |
| onShow   | 当小程序启动，或从后台进入前台显示，会触发 onShow。也可以使用 `wx.onAppShow` 绑定监听。 |
| onHide   | 当小程序从前台进入后台，会触发 onHide。也可以使用 `wx.onAppHide` 绑定监听。 |
| onError  | 当小程序发生脚本错误，或者 api 调用失败时，会触发 onError 并带上错误信息。也可以使用 `wx.onError` 绑定监听。 |

  在实际开发过程中，可以在 `onLaunch` 函数中对小程序中的数据进行初始化，比如读取本地存储里面的数据加载到小程序中。

- **页面**

  小程序的页面生命周期函数需要在页面的 .js 文件中进行声明，执行顺序也是从上到下，总共有五个：

| 函数     | 说明                                                         |
| -------- | ------------------------------------------------------------ |
| onLoad   | 页面加载时触发。一个页面只会调用一次，可以在 onLoad 的参数中获取打开当前页面路径中的参数。 |
| onShow   | 页面显示/切入前台时触发。                                    |
| onReady  | 页面初次渲染完成时触发。一个页面只会调用一次，代表页面已经准备妥当，可以和视图层进行交互。 |
| onHide   | 页面隐藏/切入后台时触发。 如 `wx.navigateTo` 或底部 `tab` 切换到其他页面，小程序切入后台等。 |
| onUnload | 页面卸载时触发。如 `wx.redirectTo` 或 `wx.navigateBack` 到其他页面时。 |

  注意：对界面内容进行设置的 API 如 `wx.setNavigationBarTitle` ，请在onReady之后进行。在开发过程中，页面数据的初始化 一般都会在 onLoad 里进行处理。